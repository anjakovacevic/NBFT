\documentclass[conference, 11pt]{IEEEtran}

\usepackage{amsmath, amssymb}
\usepackage{graphicx}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{hyperref}
\usepackage{placeins}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[serbian]{babel}

\usepackage{cite}

\usepackage{listings}
\usepackage{xcolor}
\usepackage{subcaption}

\lstset{
  basicstyle=\ttfamily\footnotesize,
  breaklines=true,
  breakatwhitespace=true,
  columns=fullflexible,
  keepspaces=true,
  frame=single,
  showstringspaces=false
}

\title{%
  \fontsize{18}{10}\selectfont
  NBFT KONSENZUS ALGORITAM%
}
%\title{\small NBFT Konsenzus Algoritam}
\author{\IEEEauthorblockN{Anja Kovačević, E2 75/2024}
\IEEEauthorblockA{Predmet: Primenjeni algoritmi u upravljačkim sistemima\\
18. decembar 2025.}}
\begin{document}

\maketitle
\thispagestyle{plain}
\pagestyle{plain}
\begin{abstract}
Ovaj rad predstavlja analizu i praktičnu implementaciju NBFT (Node-grouped Byzantine Fault Tolerance) konsenzus algoritma, dizajniranog da prevaziđe ograničenja skalabilnosti klasičnog PBFT (Practical Byzantine Fault Tolerance) protokola. Kroz uvođenje hijerarhijske organizacije čvorova formiranjem grupa i delegiranjem komunikacije na izabrane predstavnike, NBFT postiže značajno smanjenje komunikacione složenosti sa $O(n^2)$ na približno $O(n)$.
Rad detaljno opisuje razvijenu modularnu simulacionu platformu koja omogućava empirijsku verifikaciju teorijskih postavki kroz dinamičku vizuelizaciju toka poruka i batch eksperimente.
Rezultati simulacija potvrđuju da NBFT uspešno održava konzistentnost i otpornost na vizantijske greške unutar definisanih granica ($n \ge 3f+1$), dok istovremeno demonstrira superiornu skalabilnost u mrežama sa većim brojem učesnika.
\end{abstract}

\section{Uvod}

U savremenim distribuiranim sistemima, postizanje pouzdanog konsenzusa u prisustvu nepouzdanih ili zlonamernih aktera predstavlja jedan od ključnih izazova. Problem vizantijskih generala modeluje situacije u kojima komponente sistema mogu otkazati na proizvoljan način, uključujući slanje lažnih informacija ili koordinisano ometanje rada mreže \cite{lamport}.
Rešenje ovog problema zahteva algoritme koji garantuju \textit{sigurnost} (safety) i \textit{živost} (liveness) uprkos prisustvu do $f$ vizantijskih čvorova u sistemu od $n$ učesnika.

PBFT (Practical Byzantine Fault Tolerance) algoritam, predstavljen 1999. godine, postavio je standard za praktičnu primenu vizantijskog konsenzusa u asinhronim sistemima \cite{pbft}. Iako dokazano robustan, PBFT pati od kvadratne složenosti razmene poruka ($O(n^2)$), što ga čini neprikladnim za velike mreže.
Sa porastom broja čvorova, mrežni resursi postaju bottleneck, a latencija dramatično raste, ograničavajući primenu PBFT-a na male, zatvorene grupe konzorcijuma.

Kao odgovor na ovaj problem, predložen je NBFT (Node-grouped BFT) algoritam koji promoviše principe decentralizacije i demokratizacije blockchain tehnologija \cite{nbft}. NBFT uvodi inovativnu dvostepenu hijerarhijsku strukturu inspirisanu konceptom \textbf{konvolutivnog sažimanja} (convolutional pooling) iz neuronskih mreža. Ova analogija se ogleda u postepenom smanjenju broja aktivnih učesnika u procesu odlučivanja: čvorovi prvo postižu lokalni kvorum unutar svojih grupa, nakon čega predstavnici tih grupa formiraju globalni konsenzus.

U poređenju sa prethodnim rešenjima, NBFT nudi tri ključna doprinosa:
\begin{enumerate}
    \item \textbf{Skrivanje identiteta uloga}: Korišćenjem konzistentnog heširanja, uloge čvorova (ko je predstavnik, a ko primarni čvor) su nepoznate unapred. Ovo onemogućava zlonamernim akterima da fokusirano napadaju ili korumpiraju ključne čvorove pre početka consensus runde.
    \item \textbf{Napredni modeli bezbednosti}: Po prvi put se uvode \textit{Node Decision Broadcast Model} (nadzor predstavnika) i \textit{Threshold Vote-Counting Model} (ponderisano glasanje) kako bi se osigurala bezbednost uprkos smanjenju broja poruka.
    \item \textbf{Povećana granica tolerancije grešaka}: Za razliku od PBFT-a čija je granica fiksna na $1/3$, NBFT kroz svoju hijerarhijsku strukturu omogućava da verovatnoća ispravnog rada ostane visoka čak i kada je ukupan broj neispravnih čvorova veći od teorijskog praga od $1/3$, što ga čini sigurnijim i tolerantnijim na greške.
\end{enumerate}

Cilj ovog rada je:
\begin{enumerate}
    \item Teorijska analiza NBFT algoritma, njegovih modela nadzora i mehanizama za redukciju saobraćaja.
    \item Implementacija modularnog softverskog simulatora koji verno modeluje asinhronu prirodu distribuiranog sistema.
    \item Eksperimentalna evaluacija performansi i verifikacija tvrdnje o povećanoj otpornosti i skalabilnosti u odnosu na referentne modele.
\end{enumerate}

U nastavku rada date je pregled problema skalabilnosti PBFT-a, detaljan opis NBFT arhitekture, prikaz softverske implementacije, kao i analiza dobijenih eksperimentalnih rezultata.




\section{Problem skalabilnosti PBFT algoritma}

PBFT algoritam realizuje konsenzus kroz sekvencu tri jasno definisane faze: \textit{pre-prepare}, \textit{prepare} i \textit{commit} \cite{pbft}. Tokom ovih faza, primarni čvor (lider) inicira predlog odluke, nakon čega svi učesnici mreže međusobno razmenjuju poruke kako bi verifikovali ispravnost predloga i postigli globalnu saglasnost.

Dominantna karakteristika ovog procesa je zahtev za potpunom mrežnom topologijom u kojoj svaki čvor komunicira sa svim ostalim čvorovima (\textit{all-to-all communication}).
U sistemu sa $n$ čvorova, ovaj komunikacioni obrazac rezultuje složenošću od $O(n^2)$ poruka po jednoj instanci konsenzusa.
Svrha ovakvog dizajna je obezbeđivanje maksimalne sigurnosti, jer omogućava svakom ispravnom čvoru da prikupi dovoljno dokaza o ponašanju svih ostalih učesnika pre donošenja odluke. Međutim, sa aspekta skalabilnosti, ovo predstavlja ozbiljno ograničenje.

Sa linearnim porastom broja učesnika, kvadratni rast broja poruka dovodi do:
\begin{enumerate}
    \item Povećanja mrežne latencije, usled vremena potrebnog za propagaciju i obradu velikog broja poruka,
    \item Saturacije mrežnog protoka (bandwidth), što može izazvati gubitak paketa i potrebu za retransmisijom,
    \item Eksponencijalnog rasta vremena potrebnog za oporavak sistema (\textit{View Change}), što direktno ugrožava živost (\textit{liveness}) sistema.
\end{enumerate}

U praktičnim primenama, ova ograničenja svode upotrebu PBFT-a na sisteme malog obima (do nekoliko desetina čvorova). Identifikacija ovog uskog grla predstavljala je primarnu motivaciju za razvoj hijerarhijskih pristupa poput NBFT-a, čiji je cilj optimizacija komunikacione matrice bez kompromitovanja bezbednosnih garancija.

\section{NBFT algoritam}

NBFT algoritam je dizajniran sa ciljem prevazilaženja komunikacionih barijera PBFT protokola uvođenjem dvoslojne hijerarhijske arhitekture \cite{nbft}.
Osnovna ideja počiva na principu "podeli pa vladaj": umesto monolitnog konsenzusa celog sistema, proces se dekomponuje na lokalne konsenzuse unutar manjih grupa, čiji se rezultati potom agregiraju.
Ovakva struktura je uvedena kako bi se skupa globalna komunikacija zamenila efikasnijom lokalnom razmenom.

Protokol se odvija u tri ključne faze:
\begin{enumerate}
    \item \textbf{Grupisanje čvorova}: Particionisanje mreže na disjunktne podskupove.
    \item \textbf{Unutar-grupni konsenzus}: Izvršavanje PBFT instance na lokalnom nivou.
    \item \textbf{Među-grupni konsenzus}: Agregacija odluka putem predstavničkih čvorova.
\end{enumerate}

\subsection{Formiranje grupa i izbor predstavnika}

Sistem od $n$ čvorova se deterministički deli na $R$ grupa veličine $m$, pri čemu je veličina grupe diktirana zahtevom za otpornost na $f_1$ vizantijskih grešaka unutar grupe ($m \ge 3f_1 + 1$).
Unutar svake grupe bira se jedan predstavnički čvor (\textit{Representative}), čija je uloga da zastupa konsenzus svoje grupe na globalnom nivou.

Izbor predstavnika se vrši korišćenjem mehanizma \textbf{konzistentnog heširanja} (ili determinističkog mešanja).
Svrha ovog pristupa je dvostruka:
\begin{itemize}
    \item \textbf{Transparentnost}: Svi čvorovi nezavisno dolaze do istog zaključka o topologiji mreže bez potrebe za centralnim koordinatorom.
    \item \textbf{Balansiranje opterećenja}: Rotacijom uloga kroz različite poglede (\textit{Views}) sprečava se da isti čvorovi budu trajno opterećeni ulogom pregovarača, čime se povećava dugoročna stabilnost sistema.
\end{itemize}

Konsenzus se uspostavlja kroz dva nivoa:

\paragraph{1. Lokalni konsenzus (Intra-group)}
Svaka grupa nezavisno izvršava PBFT protokol. Čvorovi unutar grupe validiraju predlog i glasaju.
Cilj ove faze je da se potvrdi ispravnost transakcije na mikronivou pre nego što se ona propagira ostatku mreže.
Ukoliko se postigne kvorum, predstavnik dobija legitimitet (u vidu digitalnih potpisa članova) da prenese odluku dalje.

\paragraph{2. Globalni konsenzus (Inter-group)}
Predstavnici grupa formiraju "komitet" koji sprovodi završnu instancu konsenzusa. Oni razmenjuju agregirane odluke svojih grupa.
Razdvajanje na dva nivoa je ključni mehanizam optimizacije: umesto $n$ čvorova, u globalnoj komunikaciji učestvuje samo $R \approx n/m$ učesnika, što drastično smanjuje broj poruka.

\subsection{Watchdog mehanizam i emitovanje odluka}

S obzirom na to da predstavnički čvorovi predstavljaju kritičnu tačku neuspeha (Single Point of Failure) za svoje grupe, NBFT uvodi sigurnosni mehanizam tzv. \textbf{Watchdog}.
Regularni čvorovi pasivno nadgledaju ponašanje svog predstavnika.
Ukoliko detektuju maliciozno ponašanje (npr. predstavnik šalje odluku suprotnu onoj koja je izglasana u grupi), čvorovi imaju pravo da zaobiđu hijerarhiju i direktno emituju svoje dokaze (\textit{Fraud Proof}) ostalim grupama.

Svrha ovog mehanizma je očuvanje bezbednosti sistema (Safety) čak i u slučaju kada je predstavnik korumpiran, onemogućavajući mu da jednostrano falsifikuje volju svoje grupe.

\subsection{Ponderisano glasanje}

Kako bi se dodatno osigurala validnost odluka, NBFT primenjuje model \textbf{ponderisanog glasanja}.
Glas predstavnika u globalnom konsenzusu nema fiksnu vrednost, već je ponderisan brojem validnih potpisa koje je prikupio od svoje grupe.
Ova mera je uvedena kako bi se kvantifikovalo "poverenje" u odluku svake grupe — predstavnik koji ne može da dokaže podršku svoje baze ima marginalan uticaj na konačni ishod.

\subsection{Teorijska analiza skalabilnosti}
Analitički izraz za broj poruka u NBFT protokolu dat je formulom:
\[ C_{NBFT} = 2(n-1) + 2(m-1)\frac{n}{m} + \left(\frac{n}{m}\right)^2 \]
Prvi član predstavlja komunikaciju klijenta sa mrežom, drugi član odražava lokalnu komunikaciju unutar svih grupa, dok treći član aproksimira komunikaciju između predstavnika.
Za fiksno $m$, ukupna složenost teži $O(n)$, što predstavlja značajno teorijsko unapređenje u odnosu na $O(n^2)$ kod PBFT-a.
Ova redukcija čini osnovu za tvrdnju da je NBFT algoritam pogodan za primenu u mrežama velikih razmera (Enterprise Blockchain, IoT mreže). 
\section{Softverska arhitektura}

Realizovano rešenje predstavlja modularnu softversku platformu dizajniranu za simulaciju i analizu konsenzus algoritama.
Arhitektura sistema je zasnovana na principima objektno-orijentisanog programiranja i čistoj separaciji odgovornosti (separation of concerns), što omogućava lako održavanje i proširivanje funkcionalnosti.

\subsection{Komponente sistema}
Struktura projekta podeljena je na sledeće ključne celine:

\begin{itemize}
    \item \textbf{Domenski sloj (\texttt{nbft/models.py})}:
    Definiše osnovne entitete sistema kao što su \texttt{Node} (čvor), \texttt{Message} (poruka) i \texttt{RunConfig} (konfiguracija eksperimenta).
    Ovaj sloj koristi Python \texttt{dataclasses} za modelovanje nepromenljivih struktura podataka. Digitalni potpisi su simulirani korišćenjem \textbf{SHA-256} heš funkcije nad sadržajem poruke u kombinaciji sa jedinstvenim identifikatorom čvora (npr. \texttt{Hash(content + secret + node\_id)}), čime se omogućava verodostojna verifikacija autentičnosti i integriteta podataka bez eksternih kriptografskih biblioteka.
    
    \item \textbf{Sloj poslovne logike (\texttt{nbft/})}:
    Ovaj sloj obuhvata algoritamske module sistema. Klasa NBFTSimulator, formiranje grupa i ponašanje vizantijskih čvorova, detaljno su analizirani u narednom poglavlju.
    
    \item \textbf{Prezentacioni sloj (\texttt{app.py})}:
    Za interakciju sa korisnikom odabrana je biblioteka \textbf{Gradio}. Ona omogućava brzu generaciju modernog web GUI-a gde korisnici mogu lako da podešavaju parametre simulacije ($N, M, f$) i pokreću eksperimente. Implementirane su tri glavne funkcionalnosti:
    \begin{enumerate}
        \item \textbf{Single Simulation}: Vizuelizacija toka poruka ( Message Sequence Chart) korišćenjem biblioteke \textbf{Matplotlib}.
        \item \textbf{Batch Experiments}: Masovno pokretanje simulacija radi analize uticaja broja vizantijskih čvorova na uspeh i performanse.
        \item \textbf{Saved History}: Pregled istorijskih rezultata.
    \end{enumerate}

    \item \textbf{Sloj za perzistenciju (\texttt{db/repository.py})}:
    Za trajno čuvanje rezultata eksperimenata koristi se \textbf{SQLite} baza podataka.
\end{itemize}

\subsection{Algoritam formiranja grupa (Consistent Hashing)}
Jedna od ključnih komponenti NBFT sistema je determinističko, ali nepredvidivo formiranje grupa čime se osigurava zaštita od koordinisanih napada. Implementirani modul \texttt{consistent\_hash.py} oslanja se na koncept konzistentnog heširanja na prstenu veličine $2^{32}$ i strogo prati matematički model opisan u radu.

Proces formiranja topologije mrežne simulacije odvija se kroz sledeće faze:

\begin{enumerate}
    \item \textbf{Mapiranje čvorova}: Svaki čvor se mapira na fiksnu poziciju na prstenu koristeći heš funkciju nad svojim identifikatorom: $Pos(N_j) = Hash(ID_N) \mod 2^{32}$. Čvorovi se sortiraju u smeru kazaljke na satu.
    
    \item \textbf{Izbor globalnog primarnog čvora}: Primarni čvor nije fiksiran, već se dinamički bira za svaki pogled ($v$):
    \[ Target(v) = Hash(MasterIP_{prev} || v) \mod 2^{32} \]
    Gde je $MasterIP_{prev}$ primarni čvor prethodne runde. Čvor čija je pozicija na prstenu najbliža rezultatu u smeru kazaljke na satu postaje \textit{Global Primary}.

    \item \textbf{Grupisanje (Stride Logic)}: Čvorovi se grupišu polazeći od indeksa određenog trenutnim pogledom ($v \mod N$). Prilikom grupisanja, globalni primarni čvor se preskače, a ostali čvorovi se dodeljuju u $m$ grupa po principu "svaki $m$-ti čvor ide u istu grupu". Ovim se postiže uniformna disperzija čvorova.

    \item \textbf{Izbor predstavnika grupe}: Za svaku grupu, identifikuje se idealna pozicija:
    \[ RepTarget(g) = Hash(GlobalPrimary || v || g) \mod 2^{32} \]
    Član grupe koji je najbliži ovoj tački postaje predstavnik (\textit{Representative}).
\end{enumerate}


\begin{figure*}[htbp]
    \centering
    \begin{minipage}{0.8\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n20_m4_b0_real.png}
        \caption{Vizuelizacija faza NBFT protokola za $n=20, m=4, b=0$. Dijagram prikazuje formirane grupe i sekvencu razmene poruka kroz sve faze konsenzusa.}
        \label{fig:msg_flow}
    \end{minipage}
\end{figure*}

\subsection{Model NBFT algotima}
Klasa \texttt{NBFTSimulator} (\texttt{nbft\_sim.py}) predstavlja centralnu komponentu sistema koja orkestrira celokupan životni ciklus mrežne simulacije.
Implementacija se oslanja na \texttt{asyncio} biblioteku za modelovanje asinhronog izvršavanja, gde svaki čvor funkcioniše kao nezavisna asinhrona rutina (coroutine). Ovakav pristup omogućava verodostojnu simulaciju konkurentnosti, mrežnih kašnjenja i redosleda pristizanja poruka bez potrebe za korišćenjem resursno zahtevnih niti (threads).

Srž logike konsenzusa implementirana je kroz metodu \texttt{\_handle\_message}, koja deluje kao mašina stanja (State Machine). Proces konsenzusa je podeljen u sledeće faze, prateći hijerarhijsku strukturu predloženu u radu:

\begin{enumerate}
    \item \textbf{preprepare1}: Klijent šalje zahtev čvoru 0 (Global Primary), koji ga potom prosleđuje (broadcast) svim ostalim čvorovima u mreži.
    \item \textbf{in-prepare1}: Svaki čvor šalje poruku svom predstavniku grupe (Representative), informišući ga o zahtevu.
    \item \textbf{in-prepare2}: Nakon prikupljanja dovoljnog broja glasova unutar grupe, predstavnik šalje povratnu informaciju svim čvorovima u svojoj mapi.
    \item \textbf{out-prepare}: Predstavnici svih grupa razmenjuju ponderisane glasove (weights) međusobno radi postizanja međugrupnog dogovora.
    \item \textbf{commit}: Čim se ostvari globalni ponderisani kvorum ($2n/3$), predstavnici šalju potvrdu čvoru 0 (\textit{Replica 0}), koji deluje kao globalni koordinator.
    \item \textbf{preprepare2}: Čvor 0 prosleđuje finalnu odluku svim čvorovima u mrežni sistem.
    \item \textbf{Reply}: Svi čvorovi koji su primili finalnu odluku šalju odgovor (\textit{Reply}) direktno klijentu.
\end{enumerate}

Simulator takođe upravlja tranzicijom pogleda (\textit{View Change}) u slučaju isteka vremenskog ograničenja (timeout), osiguravajući živost sistema.

\subsection{Modelovanje Vizantijskog Ponašanja}
Testiranje otpornosti sistema vrši se pomoću klase \texttt{ByzantineBehavior} (\texttt{byzantine.py}), koja presreće izlazne poruke kompromitovanih čvorova i modifikuje ih prema zadatoj strategiji.
Implementirane strategije napada uključuju:
\begin{itemize}
    \item \textbf{Silent}: Čvor prestaje da šalje poruke, simulirajući otkaz (Crash Fault) ili namerno ćutanje.
    \item \textbf{Equivocation}: Čvor šalje različite (konfliktne) informacije različitim primaocima (npr. validan potpis jednima, nevalidan drugima).
    \item \textbf{Bad Aggregator}: Specifičan napad za NBFT predstavnike, gde korumpirani predstavnik šalje lažnu informaciju o ishodu glasanja u svojoj grupi (npr. \texttt{CORRUPTED\_AGGREGATE}), pokušavajući da prevari globalni konsenzus.
    \item \textbf{Random Noise}: Slanje nasumičnih, nevalidnih podataka radi testiranja robusnosti parsera poruka.
\end{itemize}

\subsection{Implementacija mehanizama zaštite}
Poseban fokus u implementaciji stavljen je na robusnost sistema:
\begin{itemize}
    \item \textbf{Watchdog mehanizam (Node Decision Broadcast Model)}: Čvorovi unutar grupe aktivno nadziru rad svog predstavnika. Ukoliko predstavnik u fazi \texttt{in-prepare2} pošalje poruku koja je nekonzistentna sa inicijalnim zahtevom, ili ukoliko dođe do isteka vremenskog ograničenja (timeout) bez primljene potvrde, čvorovi detektuju maliciozno ponašanje. U tom slučaju, obični čvorovi "zaobilaze" (bypass) svog predstavnika i direktno šalju svoje glasove svim predstavnicima ostalih grupa (\textit{Peer-to-Network broadcast}). Ovim mehanizmom se osigurava da glas poštenih članova bude uračunat u globalni kvorum čak i ako je njihov predstavnik kompromitovan.
    \item \textbf{Izolacija neispravnih grupa}: Tokom međugrupne komunikacije, predstavnici ignorišu glasove koji dolaze iz grupa označenih kao kompromitovane (one za koje je primljen validan alarm).
    \item \textbf{Threshold Vote-Counting Model}: Implementiran je dinamički model brojanja glasova koji minimizuje uticaj malicioznih grupa na globalni konsenzus. Ukoliko predstavnik prikupi dovoljan broj potpisa unutar svoje grupe ($\ge R - w$, gde je $R$ veličina grupe), njegov glas u \texttt{out-prepare} fazi nosi težinu pune veličine grupe ($R$). U suprotnom, glas nosi oslabljenu težinu jednaku isključivo broju prikupljenih validnih potpisa. Globalni kvorum se dostiže kada suma težina pređe prag $2n/3$ ukupne mrežne populacije.
    \item \textbf{Klijentski prag konsenzusa}: U skladu sa teorijskim modelom, klijentski terminal (Customer Service Terminal) potvrđuje uspešnost operacije tek nakon što primi $(n-1)/2 + 1$ identičnih \texttt{Reply} poruka od različitih replika u mreži.
\end{itemize}

\subsubsection{Simulacija mrežnog saobraćaja}
Klasa \texttt{NBFTSimulator} simulira mrežni sloj metodom \texttt{\_async\_send}, koja:
\begin{enumerate}
    \item Klonira poruku radi sprečavanja deljenja referenci,
    \item Uvodi veštačko kašnjenje (latency),
    \item Primenjuje definisanu vizantijsku strategiju (modifikacija ili brisanje poruke),
    \item Stavlja poruku u red događaja ciljnog čvora.
\end{enumerate}
Ovaj pristup omogućava determinističku, ali realističnu simulaciju distribuiranog okruženja.

\section{Eksperimentalna analiza}

\begin{figure*}[htbp]
    \centering
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n30_mvar1.png}
        \caption{Otpornost na greške ($n=30, m=4$)}
        \label{fig:n30_fault}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n30_mvar2.png}
        \caption{Komunikaciono opterećenje ($n=30, m=4$)}
        \label{fig:n30_comm}
    \end{subfigure}
    
    \vspace{1em}
    
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n50_m5_bdo3_1.png}
        \caption{Otpornost na greške ($n=50, m=5$)}
        \label{fig:n50_fault}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n50_m5_bdo3_2.png}
        \caption{Komunikaciono opterećenje ($n=50, m=5$)}
        \label{fig:n50_comm}
    \end{subfigure}
    
    \vspace{1em}
    
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n100_m10_b20_1.png}
        \caption{Otpornost na greške ($n=100, m=10$)}
        \label{fig:n100_fault}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/n100_m10_b20_2.png}
        \caption{Komunikaciono opterećenje ($n=100, m=10$)}
        \label{fig:n100_comm}
    \end{subfigure}
    \caption{Eksperimentalni rezultati: Poređenje PBFT i NBFT algoritama kroz metriku uspešnosti konsenzusa i broja razmenjenih poruka za različite konfiguracije mreže.}
    \label{fig:experimental_results}
\end{figure*}

Za potrebe evaluacije performansi i robusnosti NBFT algoritma, sprovedena je serija simulacija korišćenjem razvijene softverske platforme. Eksperimenti su fokusirani na dva ključna aspekta: skalabilnost u pogledu broja poruka i otpornost na vizantijske greške.

\subsection{Analiza otpornosti na greške}
Analizom rezultata prikazanih na slikama \ref{fig:n30_fault} i \ref{fig:n50_fault}, uočava se da NBFT algoritam pokazuje izuzetnu robusnost. Za mrežu od $n=30$ čvorova podeljenju u $m=4$ grupe (Slika \ref{fig:n30_fault}), stopa uspešnosti ostaje stabilna čak i kada broj vizantijskih čvorova raste do 14. Ovakav rezultat je omogućen hijerarhijskom podelom gde kvar pojedinih čvorova ne utiče nužno na kvorum ostalih grupa. Naprotiv, PBFT implementacija pokazuje brži pad performansi čim broj grešaka pređe kritičnu granicu $f$. Sličan trend je primetan i kod veće mreže ($n=50$, Slika \ref{fig:n50_fault}), gde NBFT zadržava visoku pouzdanost unutar šireg opsega grešaka.


\subsection{Analiza komunikacione složenosti}
Rezultati merenja mrežnog saobraćaja, prikazani na slikama \ref{fig:n30_comm} i \ref{fig:n50_comm}, jasno demonstriraju prednost NBFT-a u skalabilnosti. Dok PBFT generiše veliki broj poruka koji raste kvadratno sa brojem čvorova, NBFT zadržava linearnu tendenciju sa značajno manjim brojem razmenjenih paketa. 

Kod konfiguracije $n=30$ (Slika \ref{fig:n30_comm}), razlika u broju poruka je višestruka u korist NBFT algoritma. Sa daljim porastom mreže na $n=50$ čvorova (Slika \ref{fig:n50_comm}), ova diskrepanca postaje još drastičnija, potvrđujući da NBFT efektivno redukuje mrežnu saturaciju. Ovo smanjenje je vizuelno potvrđeno i kroz generisane \textit{Message Sequence Chart} dijagrame (poput Slike \ref{fig:msg_flow}), gde je vidljiva znatno manja gustina poruka u poređenju sa potpunom "all-to-all" komunikacijom kod PBFT-a.

\subsection{Ograničenja PBFT implementacije}
Važno je napomenuti da, dok NBFT implementacija sadrži napredne mehanizme oporavka (View Change) i kriptografsku zaštitu, korišćena referentna implementacija PBFT algoritma predstavlja pojednostavljenu verziju.
Konkretno, PBFT implementacija ne uključuje mehanizam za promenu pogleda niti digitalno potpisivanje poruka.
Ova simplifikacija je namerna kako bi se izolovao uticaj komunikacione složenosti na performanse, ali implicira da su rezultati otpornosti na greške za PBFT konzervativniji u odnosu na potpuno produkcionu verziju.

\section{Zaključak}

U ovom radu prezentovana je sveobuhvatna analiza i implementacija NBFT algoritma kao rešenja za inherentne probleme skalabilnosti klasičnog PBFT protokola. 
Kroz razvoj simulacione platforme, uspešno su verifikovane teorijske pretpostavke o linearnoj komunikacionoj složenosti ($O(n)$) hijerarhijskog pristupa inspirisanog konvolutivnim sažimanjem.

Glavni doprinosi rada potvrdili su da NBFT značajno unapređuje:
\begin{enumerate}
    \item \textbf{Preventivnu zaštitu}: Skrivanje uloga čvorova putem konzistentnog heširanja efikasno neutrališe napade na lidere grupa pre početka konsenzusa.
    \item \textbf{Robusne sigurnosne modele}: Implementacija \textit{Node Decision Broadcast} i \textit{Threshold Vote-Counting} modela omogućava očuvanje integriteta odluka čak i uz drastičnu redukciju broja poruka.
    \item \textbf{Superiornu fault-tolerance granicu}: Eksperimentalna i teorijska analiza potvrđuju da NBFT može održati konsenzus čak i kada procenat vizantijskih čvorova u mreži pređe klasični PBFT limit od $1/3$, zahvaljujući pametnoj distribuciji poverenja kroz grupe.
\end{enumerate}

Dobijeni rezultati sugerišu da je NBFT, prateći principe demokratizacije blockchain-a, izuzetno pogodan za primenu u specifičnim scenarijima gde je potreban visok stepen propusnosti i niska latencija. Neki od ključnih scenarija primene uključuju:
\begin{itemize}
    \item \textbf{Privatni i konzorcijumski blockchain sistemi}: Unutar korporativnih mreža gde su čvorovi već grupisani po sektorima ili organizacijama, NBFT prirodno mapira hijerarhiju na topologiju grupa.
    \item \textbf{IoT (Internet of Things) mrežni sistemi}: NBFT omogućava skaliranje kvas-decentralizovanih mreža senzora i aktuatora, gde lokalni gateway-i mogu delovati kao predstavnici grupa, smanjujući globalno opterećenje jezgra mreže.
    \item \textbf{Međubankarske transakcije i Supply Chain}: U sistemima gde se poverenje gradi unutar lokalnih klastera (npr. regionalne banke ili lokalni dobavljači), NBFT omogućava efikasna poravnanja uz minimalni mrežni overhead.
\end{itemize}


\begin{thebibliography}{1}

\bibitem{lamport}
L. Lamport, R. Shostak, and M. Pease, ``The Byzantine Generals Problem,'' \emph{ACM Trans. Program. Lang. Syst.}, vol. 4, no. 3, pp. 382--401, July 1982, doi: 10.1145/357172.357176.

\bibitem{pbft}
M. Castro and B. Liskov, ``Practical Byzantine Fault Tolerance,'' in \emph{Proc. 3rd Symp. Oper. Syst. Des. Implem. (OSDI)}, New Orleans, LA, USA, Feb. 1999, pp. 173--186.

\bibitem{nbft}
J. Yang, Z. Jia, R. Su, X. Wu, and J. Qin, ``Improved Fault-Tolerant Consensus Based on the PBFT Algorithm,'' \emph{IEEE Access}, vol. 10, pp. 30274--30283, 2022, doi: 10.1109/ACCESS.2022.3153701.

\end{thebibliography}

\end{document}
